@typeparam T where T : class, new()
@inherits FlowComponentBase<T>

<MudPaper Class="d-flex flex-row align-center gap-4 pl-4 pt-1 pb-1 pr-4" Elevation="1">

    @if (isOwnerAssigning)
    {
        <MudProgressCircular Color="Color.Default" Indeterminate="true" />
    }
    else
    {
        <MudTooltip Text="@OwnerAssignedTooltip" Arrow="true">
            <MudToggleIconButton Toggled="@OwnerAssigned"
                             Icon="@Icons.Material.Filled.PersonAdd" Color="@Color.Default"
                             ToggledIcon="@Icons.Material.Filled.PersonOff" ToggledColor="@Color.Default"
                             ToggledChanged="OnOwnerAssignedChangedAsync" />
        </MudTooltip>
    }

    @if (OwnerAssigned)
    {
        @if (ActionTextItems != null)
        {
            <MudTooltip Text="@FlowConstants.FLOW_STATE_ACTION" Arrow="true">
                <MudSelect T="string" Class="align-self-center"
                       @bind-Value="ActionText"
                       SelectedValuesChanged="OnActionChanged"
                       Variant="Variant.Text"
                       FullWidth=true
                       Margin="Margin.Dense"
                       MultiSelection="false">
                    @foreach (var actionTextItem in ActionTextItems)
                    {
                        <MudSelectItem T="string" Value="@actionTextItem">@actionTextItem</MudSelectItem>
                    }
                </MudSelect>
            </MudTooltip>
        }

        @if (ActionTargetItems != null)
        {
            <MudTooltip Text="@FlowConstants.FLOW_TARGET_STATE" Arrow="true">
                <MudSelect T="string" Class="align-self-center"
                       @bind-Value="ActionTarget"
                       SelectedValuesChanged="OnActionTargetChanged"
                       Variant="Variant.Text"
                       FullWidth=true 
                       Margin="Margin.Dense"
                       MultiSelection="false">
                    @foreach (var actionTargetItem in ActionTargetItems)
                    {
                        <MudSelectItem T="string" Value="@actionTargetItem">@actionTargetItem</MudSelectItem>
                    }
                </MudSelect>
            </MudTooltip>
        }
        
        <MudTextField @bind-Value="Comment" Label="Comment" Variant="Variant.Text" Class="flex-grow-1 align-self-center" Margin="Margin.Dense"></MudTextField>
    }

    <MudSpacer />

    @if (OwnerAssigned)
    {
        @if (isExecuting)
        {
            <MudProgressCircular Color="Color.Default" Indeterminate="true" />
        }
        else
        {
            <MudTooltip Text="@FlowConstants.FLOW_ACTION_EXECUTE" Arrow="true">
                <MudIconButton Icon="@Icons.Material.Filled.PlayCircleFilled" Color="@Color.Default" OnClick="OnExecutingClick" />
            </MudTooltip>
        }
    }

</MudPaper>